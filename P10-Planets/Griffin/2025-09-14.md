Work over the weekend our starting point was this function: 

```python 
def kappa_cont(nu, log10P, T):

"""Compute the continuum opacity in cgs units as a function of

log pressure (CGS) and K.

Parameters:

nu: numpy array

log10P: float

T: float

"""

T_val = T.to_value(u.K) if hasattr(T, 'unit') else T

nHI = 10**(log10ns[0](log10P, T_val, grid=False))

nHII = 10**(log10ns[1](log10P, T_val, grid=False))

nHm = 10**(log10ns[2](log10P, T_val, grid=False))

ne = 10**(log10ne(log10P, T_val, grid=False))

kappa = nHI * Hbf(nu, T_val) + nHII * ne * Hff(nu, T_val) + \

nHm * Hmbf(nu, T_val) + nHI * ne * Hmff(nu, T_val)

return kappa
```


My understanding of how its calculating kappa: 

Makes sure temp is in Kelvin
```python
T_val = T.to_value(u.K) if hasattr(T, 'unit') else T 
```

n*** varibles are calculating number density and the:

- Hbf(nu, T_val)
- Hff(nu, T_val)
- Hmbf(nu, T_val)
- Hmff(nu, T_val)

Functions are calculating the crossections, with Kappa calcaluted as: 
$$\kappa_\nu = \sum_{i}n_i \sigma_{i,\nu}$$


Major problem to figure out is going to be the crossections for He. 


- https://academic.oup.com/mnras/article/269/4/871/982095 found this but its for He negative and 1400–10080 K. 
- https://chiantipy.readthedocs.io/en/latest/ thought about using this but its only for higher temperatures 
Potential ???
- [[@marrAbsolutePhotoionizationCrosssection1976]]
- [[@brownPhotoionizationCrossSectionsHeliumLike1971]]
- https://iopscience.iop.org/article/10.1086/305420/fulltext/

Temp still high but best one yet: 

[[@marigoUpdatedLowtemperatureGas2022]]

![[Image/marigoUpdatedLowtemperatureGas2022/image-3-x23-y186.png]] 

Temperature range is: 
1500 ≲ _T_/K ≲ 10,000 


>[!note]
>Not to sure why this is included as it seem to do the same thing as def kappa_cont except you can directly use the fits file 
>```python
>def kappa_cont_H(nu, T, nHI, nHII, nHm, ne):
"""Compute the continuum opacity in cgs units as a function of
temperature in K and number densities.
"""
kappa = nHI * Hbf(nu, T) + nHII * ne * Hff(nu, T) + \
nHm * Hmbf(nu, T) + nHI * ne * Hmff(nu, T)
return kappa 
>```
>Also I rembered that in class mike mentioned something about the saha equation being a bit more complicated for molecules [[@soaresNonGaussianThermostatisticalConsiderations2019]] so I went looking and turns out that: "Molecules and molecular ions have other degrees of freedom, like vibration and rotation. Because of that the equation needs to be modified in such a way to take these features into account."
>will ask mike and group about saha equation because I think i remember mention of there already being a complex saha equation available 
>Will ask about on Tuesday to double check this 








