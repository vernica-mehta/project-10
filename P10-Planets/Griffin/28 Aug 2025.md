

![[Pasted image 20250828114137.png]]



# Code Breakdown 

#### Structure.py 



```python
def T_tau(tau, Teff):

"""

Temperature for a simplified grey atmosphere, with an analytic

approximation for the Hopf q (feel free to check this!)

"""

q = 0.71044 - 0.1*np.exp(-2.0*tau)

T = (0.75*Teff**4*(tau + q))**.25

return T
```



**Rosseland mean opacity** -> created fits file via opac.py

Rosseland mean opacity is the harmonic opacity mean (i.e. inverse of average mean free path), weighted by the Planck function derivative,The deep atmosphere can always be considered “grey” as long as the Rosseland mean opacity is used.  -> This comes lecture 5 slides. 

$$
\frac{1}{\chi_R}=\int_0^\infty{\frac{1}{\chi_R}\frac{dB_{\nu}}{dT}d\nu/\frac{dB_{\nu}}{dT}}
$$


```python
#Create our interpolator functions
f_kappa_bar_Ross = RegularGridInterpolator((Ps_log10, T_grid), kappa_bar_Ross)
```

Pressure balance 
```python 
def dPdtau(_, P, T):

"""

Compute the derivative of pressure with respect to optical depth.

"""

kappa_bar = f_kappa_bar_Ross((np.log10(P), T))

return g / kappa_bar
```
